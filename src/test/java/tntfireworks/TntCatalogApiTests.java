package tntfireworks;

import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;

import org.junit.Assert;
import org.mockito.ArgumentCaptor;
import org.mockito.Mockito;
import org.mockito.MockitoAnnotations;
import org.skyscreamer.jsonassert.JSONAssert;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.reflect.TypeToken;
import com.squareup.connect.v2.Catalog;
import com.squareup.connect.v2.CatalogAdapter;
import com.squareup.connect.v2.CatalogItemVariation;
import com.squareup.connect.v2.CatalogObject;
import com.squareup.connect.v2.Location;
import com.squareup.connect.v2.LocationsAdapter;
import com.squareup.connect.v2.SquareClientV2;

import junit.framework.TestCase;
import util.SquarePayload;

public class TntCatalogApiTests extends TestCase {

    private static final String apiUrl = "https://connect.squareupstaging.com";
    private static final String deploymentJson = "{\"merchantId\":\"3M4YT8JKYHAVJ\",\"accessToken\":\"sq0ats-RSCJWip1Slxf71xI4YKI1w\",\"merchantAlias\":\"Tnt Fireworks 1\",\"legacySingleLocationSquareAccount\":false}";
    private static final String locationMarketingPlanCacheJson = "{\"FAL0004\":\"2TNTC\",\"FAL0002\":\"2TNTC\",\"AZP0002\":\"2TNTC\",\"TX 0489\":\"6LAR\",\"AZP0001\":\"6LAR\"}";
    private static final String marketingPlanItemsCacheJson = "{\"2TNTC\":[{\"number\":\"100138\",\"category\":\"ASSORTMENTS\",\"description\":\"BURSTING W/PRIDE POLYBAG\",\"suggestedPrice\":\"29.99\",\"upc\":\"27736000289\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"},{\"number\":\"100382\",\"category\":\"ASSORTMENTS\",\"description\":\"TNT HOT SHOT BAG C\",\"suggestedPrice\":\"14.99\",\"upc\":\"27736000098\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"},{\"number\":\"100605\",\"category\":\"ASSORTMENTS\",\"description\":\"RED DEVIL TRAY SS\",\"suggestedPrice\":\"39.99\",\"upc\":\"27736031030\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"},{\"number\":\"100687\",\"category\":\"ASSORTMENTS\",\"description\":\"SUPER TNT TRAY C     4/1\",\"suggestedPrice\":\"79.99\",\"upc\":\"27736003037\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"},{\"number\":\"100690\",\"category\":\"ASSORTMENTS\",\"description\":\"SUPER TNT SS\",\"suggestedPrice\":\"39.99\",\"upc\":\"27736031054\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"},{\"number\":\"100934\",\"category\":\"ASSORTMENTS\",\"description\":\"GOODY BAG SS  PDQ\",\"suggestedPrice\":\"9.99\",\"upc\":\"27736012510\",\"marketingPlan\":\"2TNTC\",\"currency\":\"USD\"}],\"6LAR\":[{\"number\":\"100068\",\"category\":\"ASSORTMENTS\",\"description\":\"BATTLE CRY ASSORTMENT C\",\"suggestedPrice\":\"19.99\",\"upc\":\"27736000036\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"},{\"number\":\"100075\",\"category\":\"ASSORTMENTS\",\"description\":\"BIG BOMB TRAY SS\",\"suggestedPrice\":\"39.99\",\"upc\":\"27736024421\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"},{\"number\":\"100603\",\"category\":\"ASSORTMENTS\",\"description\":\"RED DEVIL TRAY C\",\"suggestedPrice\":\"39.99\",\"upc\":\"27736010509\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"},{\"number\":\"100687\",\"category\":\"ASSORTMENTS\",\"description\":\"SUPER TNT TRAY C     4/1\",\"suggestedPrice\":\"39.99\",\"upc\":\"27736003037\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"},{\"number\":\"100731\",\"category\":\"ASSORTMENTS\",\"description\":\"BLAST C\",\"suggestedPrice\":\"69.99\",\"upc\":\"27736006557\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"},{\"number\":\"100934\",\"category\":\"ASSORTMENTS\",\"description\":\"GOODY BAG SS  PDQ\",\"suggestedPrice\":\"6.99\",\"upc\":\"27736012510\",\"marketingPlan\":\"6LAR\",\"currency\":\"USD\"}]}";
    private static final String locationsJson = "[{\"id\":\"7Y9J7C251APH3\",\"name\":\"6924 HWY 359 (#TX 0489)\",\"address\":{\"address_line_1\":\"450 14th St\",\"address_line_2\":\"\",\"locality\":\"San Francisco\",\"administrative_district_level_1\":\"CA\",\"postal_code\":\"94103-2316\",\"country\":\"US\"},\"timezone\":\"America/Los_Angeles\",\"capabilities\":[\"CREDIT_CARD_PROCESSING\"]},{\"id\":\"F8M9VD8NNBQ7J\",\"name\":\"VACANT LOT (#FAL0004)\",\"address\":{\"address_line_1\":\"450 14th St\",\"address_line_2\":\"\",\"locality\":\"San Francisco\",\"administrative_district_level_1\":\"CA\",\"postal_code\":\"94103-2316\",\"country\":\"US\"},\"timezone\":\"America/Los_Angeles\",\"capabilities\":[\"CREDIT_CARD_PROCESSING\"]},{\"id\":\"2QD45WEE8B1BW\",\"name\":\"WHEELER ALEX CITY MARKETPLACE (#FAL0002)\",\"address\":{\"address_line_1\":\"450 14th St\",\"address_line_2\":\"\",\"locality\":\"San Francisco\",\"administrative_district_level_1\":\"CA\",\"postal_code\":\"94103-2316\",\"country\":\"US\"},\"timezone\":\"America/Los_Angeles\",\"capabilities\":[\"CREDIT_CARD_PROCESSING\"]}]";
    private static final String catalogWithCategoriesOnlyJson = "{\"items\":{},\"categories\":{\"SPARKLERS\":{\"type\":\"CATEGORY\",\"id\":\"KWEIYGPIXP3KVG5PZWPVY5PK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPARKLERS\"}},\"ASSORTMENTS\":{\"type\":\"CATEGORY\",\"id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ASSORTMENTS\"}},\"CALIFORNIA FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"MNHQ36C7XMKAFUOUY2O3I3IK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CALIFORNIA FOUNTAINS\"}},\"PUNK\":{\"type\":\"CATEGORY\",\"id\":\"7MRTKG4VWGP6DSFREOYMQMWZ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PUNK\"}},\"CONE FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"JVTEXQG2S546O7BRUKYZBO7J\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CONE FOUNTAINS\"}},\"BASE FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"NM3HKPXQ65IHGNZUOQINAQTL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"BASE FOUNTAINS\"}},\"SPECIAL AERIALS\":{\"type\":\"CATEGORY\",\"id\":\"NWTOKKU3ZETJZRS75HHFMNRH\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPECIAL AERIALS\"}},\"FIRECRACKERS\":{\"type\":\"CATEGORY\",\"id\":\"G7VTLCWM6ULXXGSMFD3LHXMW\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"FIRECRACKERS\"}},\"RELOADABLES\":{\"type\":\"CATEGORY\",\"id\":\"V2XV6VKLSPVUP36C5GVZXPHL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"RELOADABLES\"}},\"MULTI-AERIALS\":{\"type\":\"CATEGORY\",\"id\":\"QNW2SBGBEELNVMXBWALQWWWU\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MULTI-AERIALS\"}},\"PROMOTIONAL\":{\"type\":\"CATEGORY\",\"id\":\"BZLE6QMRFPNPCDL57RBADPCR\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PROMOTIONAL\"}},\"PARACHUTES\":{\"type\":\"CATEGORY\",\"id\":\"7T4ZLSUEFKP2HYSJNCO7QJRK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PARACHUTES\"}},\"GROUND SPINNERS \\u0026 CHASERS\":{\"type\":\"CATEGORY\",\"id\":\"VZXAUZ2ZINUUWOF7Z3XENM37\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"GROUND SPINNERS \\u0026 CHASERS\"}},\"TOYS\":{\"type\":\"CATEGORY\",\"id\":\"ZPVDZ55PSRGBZRR4RUDBSMEV\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"TOYS\"}},\"ROMAN CANDLES\":{\"type\":\"CATEGORY\",\"id\":\"JAF6DFEINAIOQDKRZXLQGEOL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROMAN CANDLES\"}},\"COUNTER CASES \\u0026 DISPLAYS\":{\"type\":\"CATEGORY\",\"id\":\"FV2HKIC5CTEZUUKEMGF36KN2\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"COUNTER CASES \\u0026 DISPLAYS\"}},\"SMOKE\":{\"type\":\"CATEGORY\",\"id\":\"ZR4T66QI4OPXYP4ZUAYCHXZZ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SMOKE\"}},\"MISSILES\":{\"type\":\"CATEGORY\",\"id\":\"IM5XW6PFZXW7AAIOGKHU7APN\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MISSILES\"}},\"SUB ASSESMBLIES\":{\"type\":\"CATEGORY\",\"id\":\"GJTXQ6LUCTQYLXEIOSEMF7ET\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SUB ASSESMBLIES\"}},\"NOVELTIES\":{\"type\":\"CATEGORY\",\"id\":\"XSYJXCBBMJP7PH3X7CCODQT2\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"NOVELTIES\"}},\"MATERIALS\":{\"type\":\"CATEGORY\",\"id\":\"AQQH5LNZ5B62VRAALURQLD45\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MATERIALS\"}},\"ROCKETS\":{\"type\":\"CATEGORY\",\"id\":\"F7JE6I2PADZZXUJKOWOEY7L7\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROCKETS\"}},\"HELICOPTERS\":{\"type\":\"CATEGORY\",\"id\":\"3SO5GDFYHLQ5BS6L3ZI665TQ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"HELICOPTERS\"}}},\"taxes\":{},\"discounts\":{},\"modifierLists\":{},\"itemsPrimaryKey\":\"SKU\",\"categoriesPrimaryKey\":\"NAME\",\"taxesPrimaryKey\":\"ID\",\"discountsPrimaryKey\":\"NAME\",\"modifierListsPrimaryKey\":\"NAME\"}";
    private static final String ItemsToInsertJson = "[{\"type\":\"ITEM\",\"id\":\"#c585a0bd-a62c-4c9b-a2f1-1073fb03193b\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"RED DEVIL TRAY C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#19f547a3-5492-4356-8999-ea5db4560de4\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"#c585a0bd-a62c-4c9b-a2f1-1073fb03193b\",\"name\":\"100603\",\"sku\":\"27736010509\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#4de76495-34ac-4737-b5d8-3a804f41c3a2\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\",\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"SUPER TNT TRAY C     4/1\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#01c6fcdc-5ecf-432b-94f5-148582268206\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\",\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#4de76495-34ac-4737-b5d8-3a804f41c3a2\",\"name\":\"100687\",\"sku\":\"27736003037\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":7999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":7999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#e0794dd6-c87b-4613-a0eb-94ff6fd8b9d1\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"TNT HOT SHOT BAG C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#3c86b433-07bf-4e9f-92f1-d00db9f05624\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#e0794dd6-c87b-4613-a0eb-94ff6fd8b9d1\",\"name\":\"100382\",\"sku\":\"27736000098\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#b11f0e5d-df65-40d3-81e1-e5962bf927ce\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BIG BOMB TRAY SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#17615127-5e0f-4adc-af40-45a444a1fcc4\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"#b11f0e5d-df65-40d3-81e1-e5962bf927ce\",\"name\":\"100075\",\"sku\":\"27736024421\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#e31b4c0f-20a2-4798-902b-37ec16b8ce68\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"RED DEVIL TRAY SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#f8add51f-c640-4caf-a6b8-511ec6d58ef5\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#e31b4c0f-20a2-4798-902b-37ec16b8ce68\",\"name\":\"100605\",\"sku\":\"27736031030\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#21cde78f-63b5-42ac-b61a-c3aa08285462\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"SUPER TNT SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#1ee79d8f-a69d-424c-ad69-87df5ce2c900\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#21cde78f-63b5-42ac-b61a-c3aa08285462\",\"name\":\"100690\",\"sku\":\"27736031054\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#8fd171ef-fe5e-4fb1-a239-c7146814888b\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\",\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"GOODY BAG SS  PDQ\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#d5653e45-7c6c-4d4a-a64d-5a7845464936\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\",\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#8fd171ef-fe5e-4fb1-a239-c7146814888b\",\"name\":\"100934\",\"sku\":\"27736012510\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":699,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":699,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#506f153d-a91f-4867-9216-00f4a1203bf7\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"BURSTING W/PRIDE POLYBAG\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#0a619438-144d-4090-91ca-17b3b398ec58\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"#506f153d-a91f-4867-9216-00f4a1203bf7\",\"name\":\"100138\",\"sku\":\"27736000289\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#a59deead-fe2b-460a-8d50-affceaeb883a\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BATTLE CRY ASSORTMENT C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#34377eeb-b37c-486d-94e9-c0aeefefbaf9\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"#a59deead-fe2b-460a-8d50-affceaeb883a\",\"name\":\"100068\",\"sku\":\"27736000036\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":1999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":1999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"ITEM\",\"id\":\"#80f71401-a529-4f6f-986c-a8007487c48f\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BLAST C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"#54c8a2b4-6c38-4ef2-816f-9eb997743f7a\",\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"#80f71401-a529-4f6f-986c-a8007487c48f\",\"name\":\"100731\",\"sku\":\"27736006557\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":6999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":6999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},{\"type\":\"CATEGORY\",\"id\":\"KWEIYGPIXP3KVG5PZWPVY5PK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPARKLERS\"}},{\"type\":\"CATEGORY\",\"id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ASSORTMENTS\"}},{\"type\":\"CATEGORY\",\"id\":\"MNHQ36C7XMKAFUOUY2O3I3IK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CALIFORNIA FOUNTAINS\"}},{\"type\":\"CATEGORY\",\"id\":\"7MRTKG4VWGP6DSFREOYMQMWZ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PUNK\"}},{\"type\":\"CATEGORY\",\"id\":\"JVTEXQG2S546O7BRUKYZBO7J\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CONE FOUNTAINS\"}},{\"type\":\"CATEGORY\",\"id\":\"NM3HKPXQ65IHGNZUOQINAQTL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"BASE FOUNTAINS\"}},{\"type\":\"CATEGORY\",\"id\":\"NWTOKKU3ZETJZRS75HHFMNRH\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPECIAL AERIALS\"}},{\"type\":\"CATEGORY\",\"id\":\"G7VTLCWM6ULXXGSMFD3LHXMW\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"FIRECRACKERS\"}},{\"type\":\"CATEGORY\",\"id\":\"V2XV6VKLSPVUP36C5GVZXPHL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"RELOADABLES\"}},{\"type\":\"CATEGORY\",\"id\":\"QNW2SBGBEELNVMXBWALQWWWU\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MULTI-AERIALS\"}},{\"type\":\"CATEGORY\",\"id\":\"BZLE6QMRFPNPCDL57RBADPCR\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PROMOTIONAL\"}},{\"type\":\"CATEGORY\",\"id\":\"7T4ZLSUEFKP2HYSJNCO7QJRK\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PARACHUTES\"}},{\"type\":\"CATEGORY\",\"id\":\"VZXAUZ2ZINUUWOF7Z3XENM37\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"GROUND SPINNERS \\u0026 CHASERS\"}},{\"type\":\"CATEGORY\",\"id\":\"ZPVDZ55PSRGBZRR4RUDBSMEV\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"TOYS\"}},{\"type\":\"CATEGORY\",\"id\":\"JAF6DFEINAIOQDKRZXLQGEOL\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROMAN CANDLES\"}},{\"type\":\"CATEGORY\",\"id\":\"FV2HKIC5CTEZUUKEMGF36KN2\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"COUNTER CASES \\u0026 DISPLAYS\"}},{\"type\":\"CATEGORY\",\"id\":\"ZR4T66QI4OPXYP4ZUAYCHXZZ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SMOKE\"}},{\"type\":\"CATEGORY\",\"id\":\"IM5XW6PFZXW7AAIOGKHU7APN\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MISSILES\"}},{\"type\":\"CATEGORY\",\"id\":\"GJTXQ6LUCTQYLXEIOSEMF7ET\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SUB ASSESMBLIES\"}},{\"type\":\"CATEGORY\",\"id\":\"XSYJXCBBMJP7PH3X7CCODQT2\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"NOVELTIES\"}},{\"type\":\"CATEGORY\",\"id\":\"AQQH5LNZ5B62VRAALURQLD45\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MATERIALS\"}},{\"type\":\"CATEGORY\",\"id\":\"F7JE6I2PADZZXUJKOWOEY7L7\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROCKETS\"}},{\"type\":\"CATEGORY\",\"id\":\"3SO5GDFYHLQ5BS6L3ZI665TQ\",\"updated_at\":\"2017-03-03T00:56:37.837Z\",\"version\":1488502597837,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"HELICOPTERS\"}}]";
    private static final String catalogAfterItemInserted = "{\"items\":{\"27736010509\":{\"type\":\"ITEM\",\"id\":\"H5GWCEDY2NBGFO4IYKFMVPQI\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"RED DEVIL TRAY C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"2FX3BTSEAEDDTBBVAJR2JAGQ\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"H5GWCEDY2NBGFO4IYKFMVPQI\",\"name\":\"100603\",\"sku\":\"27736010509\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736003037\":{\"type\":\"ITEM\",\"id\":\"J6KGJFI2HMEF6AINWPASXGUP\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"7Y9J7C251APH3\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"SUPER TNT TRAY C     4/1\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"7HVATPHAYMNIJMOKHQA5MLO4\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"7Y9J7C251APH3\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"J6KGJFI2HMEF6AINWPASXGUP\",\"name\":\"100687\",\"sku\":\"27736003037\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":7999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":7999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736000098\":{\"type\":\"ITEM\",\"id\":\"EJCMHKRXYLIGDD2PRISX2LSK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"TNT HOT SHOT BAG C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"YE2TAZPEM74MYU4DVMLBKCBQ\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"EJCMHKRXYLIGDD2PRISX2LSK\",\"name\":\"100382\",\"sku\":\"27736000098\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":1499,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736024421\":{\"type\":\"ITEM\",\"id\":\"RAK2GRY623I5O5YJHUQNEAB6\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BIG BOMB TRAY SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"AACSSFFE4N64WNDGXEUKWNGA\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"RAK2GRY623I5O5YJHUQNEAB6\",\"name\":\"100075\",\"sku\":\"27736024421\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736031030\":{\"type\":\"ITEM\",\"id\":\"H5IYWQLVIP5L2U33W3VAH5S3\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"RED DEVIL TRAY SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"LT3KDSB354MR6WIVIAYV4NAO\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"H5IYWQLVIP5L2U33W3VAH5S3\",\"name\":\"100605\",\"sku\":\"27736031030\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736031054\":{\"type\":\"ITEM\",\"id\":\"LTYMNZEJSHDUFNA2LPVS4RL4\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"SUPER TNT SS\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"4XB7FQXNVFIZD2D7DPLA6XOK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"LTYMNZEJSHDUFNA2LPVS4RL4\",\"name\":\"100690\",\"sku\":\"27736031054\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":3999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736012510\":{\"type\":\"ITEM\",\"id\":\"LZHJVHMDOIY77HGWN5ZI5ZEU\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"7Y9J7C251APH3\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"GOODY BAG SS  PDQ\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"7VO5DT2UF576OCRNOVWYORQE\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"7Y9J7C251APH3\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"LZHJVHMDOIY77HGWN5ZI5ZEU\",\"name\":\"100934\",\"sku\":\"27736012510\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":699,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":699,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736000289\":{\"type\":\"ITEM\",\"id\":\"5I5RNCYDNAJZXIZXI3DYQBFJ\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_data\":{\"name\":\"BURSTING W/PRIDE POLYBAG\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"Y3L3M3FS4I7WF27BXA5HY2OK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"2QD45WEE8B1BW\",\"F8M9VD8NNBQ7J\"],\"item_variation_data\":{\"item_id\":\"5I5RNCYDNAJZXIZXI3DYQBFJ\",\"name\":\"100138\",\"sku\":\"27736000289\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"2QD45WEE8B1BW\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"},{\"location_id\":\"F8M9VD8NNBQ7J\",\"price_money\":{\"amount\":2999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736000036\":{\"type\":\"ITEM\",\"id\":\"NQEPAWQKLYCVWKM3CRJE4NJ2\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BATTLE CRY ASSORTMENT C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"OQLLOOSCVMFC264JSSQCXN6V\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"NQEPAWQKLYCVWKM3CRJE4NJ2\",\"name\":\"100068\",\"sku\":\"27736000036\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":1999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":1999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}},\"27736006557\":{\"type\":\"ITEM\",\"id\":\"BXAEZ335VCVITNXRNQOPOXKP\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_data\":{\"name\":\"BLAST C\",\"available_online\":false,\"available_for_pickup\":false,\"available_electronically\":false,\"category_id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"variations\":[{\"type\":\"ITEM_VARIATION\",\"id\":\"NUVJNU6MWWCMQJJHYYAW6JA3\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":false,\"present_at_location_ids\":[\"7Y9J7C251APH3\"],\"item_variation_data\":{\"item_id\":\"BXAEZ335VCVITNXRNQOPOXKP\",\"name\":\"100731\",\"sku\":\"27736006557\",\"ordinal\":0,\"pricing_type\":\"FIXED_PRICING\",\"price_money\":{\"amount\":6999,\"currency\":\"USD\"},\"location_overrides\":[{\"location_id\":\"7Y9J7C251APH3\",\"price_money\":{\"amount\":6999,\"currency\":\"USD\"},\"pricing_type\":\"FIXED_PRICING\"}],\"track_inventory\":false,\"inventory_alert_type\":\"NONE\",\"inventory_alert_threshold\":0}}]}}},\"categories\":{\"SPARKLERS\":{\"type\":\"CATEGORY\",\"id\":\"KWEIYGPIXP3KVG5PZWPVY5PK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPARKLERS\"}},\"ASSORTMENTS\":{\"type\":\"CATEGORY\",\"id\":\"5WHOXM7U5LO7ZEA7XQKCXO6O\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ASSORTMENTS\"}},\"CALIFORNIA FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"MNHQ36C7XMKAFUOUY2O3I3IK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CALIFORNIA FOUNTAINS\"}},\"PUNK\":{\"type\":\"CATEGORY\",\"id\":\"7MRTKG4VWGP6DSFREOYMQMWZ\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PUNK\"}},\"CONE FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"JVTEXQG2S546O7BRUKYZBO7J\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"CONE FOUNTAINS\"}},\"BASE FOUNTAINS\":{\"type\":\"CATEGORY\",\"id\":\"NM3HKPXQ65IHGNZUOQINAQTL\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"BASE FOUNTAINS\"}},\"SPECIAL AERIALS\":{\"type\":\"CATEGORY\",\"id\":\"NWTOKKU3ZETJZRS75HHFMNRH\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SPECIAL AERIALS\"}},\"FIRECRACKERS\":{\"type\":\"CATEGORY\",\"id\":\"G7VTLCWM6ULXXGSMFD3LHXMW\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"FIRECRACKERS\"}},\"RELOADABLES\":{\"type\":\"CATEGORY\",\"id\":\"V2XV6VKLSPVUP36C5GVZXPHL\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"RELOADABLES\"}},\"MULTI-AERIALS\":{\"type\":\"CATEGORY\",\"id\":\"QNW2SBGBEELNVMXBWALQWWWU\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MULTI-AERIALS\"}},\"PROMOTIONAL\":{\"type\":\"CATEGORY\",\"id\":\"BZLE6QMRFPNPCDL57RBADPCR\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PROMOTIONAL\"}},\"PARACHUTES\":{\"type\":\"CATEGORY\",\"id\":\"7T4ZLSUEFKP2HYSJNCO7QJRK\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"PARACHUTES\"}},\"GROUND SPINNERS \\u0026 CHASERS\":{\"type\":\"CATEGORY\",\"id\":\"VZXAUZ2ZINUUWOF7Z3XENM37\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"GROUND SPINNERS \\u0026 CHASERS\"}},\"TOYS\":{\"type\":\"CATEGORY\",\"id\":\"ZPVDZ55PSRGBZRR4RUDBSMEV\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"TOYS\"}},\"ROMAN CANDLES\":{\"type\":\"CATEGORY\",\"id\":\"JAF6DFEINAIOQDKRZXLQGEOL\",\"updated_at\":\"2017-03-03T00:56:38.464Z\",\"version\":1488502598464,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROMAN CANDLES\"}},\"COUNTER CASES \\u0026 DISPLAYS\":{\"type\":\"CATEGORY\",\"id\":\"FV2HKIC5CTEZUUKEMGF36KN2\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"COUNTER CASES \\u0026 DISPLAYS\"}},\"SMOKE\":{\"type\":\"CATEGORY\",\"id\":\"ZR4T66QI4OPXYP4ZUAYCHXZZ\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SMOKE\"}},\"MISSILES\":{\"type\":\"CATEGORY\",\"id\":\"IM5XW6PFZXW7AAIOGKHU7APN\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MISSILES\"}},\"SUB ASSESMBLIES\":{\"type\":\"CATEGORY\",\"id\":\"GJTXQ6LUCTQYLXEIOSEMF7ET\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"SUB ASSESMBLIES\"}},\"NOVELTIES\":{\"type\":\"CATEGORY\",\"id\":\"XSYJXCBBMJP7PH3X7CCODQT2\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"NOVELTIES\"}},\"MATERIALS\":{\"type\":\"CATEGORY\",\"id\":\"AQQH5LNZ5B62VRAALURQLD45\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"MATERIALS\"}},\"ROCKETS\":{\"type\":\"CATEGORY\",\"id\":\"F7JE6I2PADZZXUJKOWOEY7L7\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"ROCKETS\"}},\"HELICOPTERS\":{\"type\":\"CATEGORY\",\"id\":\"3SO5GDFYHLQ5BS6L3ZI665TQ\",\"updated_at\":\"2017-03-03T00:56:38.754Z\",\"version\":1488502598754,\"is_deleted\":false,\"present_at_all_locations\":true,\"category_data\":{\"name\":\"HELICOPTERS\"}}},\"taxes\":{},\"discounts\":{},\"modifierLists\":{},\"itemsPrimaryKey\":\"SKU\",\"categoriesPrimaryKey\":\"NAME\",\"taxesPrimaryKey\":\"ID\",\"discountsPrimaryKey\":\"NAME\",\"modifierListsPrimaryKey\":\"NAME\"}";
    private static final Type hashmapStringString = new TypeToken<HashMap<String, String>>() {
    }.getType();
    private static final Type hashmapStringListCsvItem = new TypeToken<HashMap<String, List<CsvItem>>>() {
    }.getType();
    private static final String ITEM = null;

    @Override
    protected void setUp() {
        MockitoAnnotations.initMocks(this);
    }

    public void testTntCatalogApiConstructor() throws Exception {

        GsonBuilder builder = new GsonBuilder();
        Gson gson = builder.create();

        SquarePayload deployment = gson.fromJson(deploymentJson, SquarePayload.class);
        HashMap<String, String> locationMarketingPlanCache = gson.fromJson(locationMarketingPlanCacheJson,
                hashmapStringString);
        HashMap<String, List<CsvItem>> marketingPlanItemsCache = gson.fromJson(marketingPlanItemsCacheJson,
                hashmapStringListCsvItem);
        Location[] locationResults = gson.fromJson(locationsJson, Location[].class);

        //SquareClientV2 client = new SquareClientV2(apiUrl, deployment.getAccessToken());

        SquareClientV2 client = Mockito.mock(SquareClientV2.class);
        LocationsAdapter locationsAdapter = Mockito.mock(LocationsAdapter.class);
        CatalogAdapter catalogAdapter = Mockito.mock(CatalogAdapter.class);

        Mockito.when(locationsAdapter.list()).thenReturn(locationResults);
        Mockito.when(client.locations()).thenReturn(locationsAdapter);
        Mockito.when(client.catalog()).thenReturn(catalogAdapter);

        TntCatalogApi tntCatalogApi = new TntCatalogApi(client, locationMarketingPlanCache, marketingPlanItemsCache);

        Mockito.verify(locationsAdapter).list();
        Mockito.verify(client).locations();

        HashMap<String, List<String>> marketingPlanLocationsCache = Mockito
                .spy(tntCatalogApi.marketingPlanLocationsCache);

        Assert.assertTrue(marketingPlanLocationsCache.containsKey("2TNTC"));
        Assert.assertTrue(marketingPlanLocationsCache.containsKey("6LAR"));
        Assert.assertTrue(marketingPlanLocationsCache.size() == 2);

        String[] squareLocations = new String[] { "F8M9VD8NNBQ7J", "2QD45WEE8B1BW" };
        ArrayList<String> squareLocationsArray = new ArrayList<String>(Arrays.asList(squareLocations));

        Assert.assertTrue(marketingPlanLocationsCache.get("2TNTC").containsAll(squareLocationsArray));
        Assert.assertTrue(marketingPlanLocationsCache.get("2TNTC").size() == 2);
        Assert.assertTrue(marketingPlanLocationsCache.get("6LAR").size() == 1);
        Assert.assertTrue(marketingPlanLocationsCache.get("6LAR").contains("7Y9J7C251APH3"));

        Mockito.verify(client).catalog();

    }

    public void testCategories() {
        //TODO: Wtsang - write this test
    }

    private CatalogObject[] stripItemAndVariationIds(CatalogObject[] catalogObjectArray) {
        for (CatalogObject catalogObject : catalogObjectArray) {
            catalogObject.setId(null);
            catalogObject.setUpdatedAt(null);
            catalogObject.setVersion(null);
            if (catalogObject.getType().equals("ITEM")) {
                if (catalogObject.getItemData() != null && catalogObject.getItemData().getVariations() != null) {
                    for (CatalogObject itemVariation : catalogObject.getItemData().getVariations()) {
                        itemVariation.setId(null);
                        CatalogItemVariation variationData = itemVariation.getItemVariationData();
                        itemVariation.setId(null);
                        itemVariation.setUpdatedAt(null);
                        itemVariation.setVersion(null);
                        if (variationData != null) {
                            variationData.setItemId(null);
                        }
                    }
                }
            }
        }
        return catalogObjectArray;
    }

    private void assertCatalogsEqual(CatalogObject[] expected, CatalogObject[] actual) throws Exception {
        GsonBuilder builder = new GsonBuilder();
        Gson gson = builder.create();

        String expectedJson = gson.toJson(expected);
        String actualJson = gson.toJson(actual);

        System.out.println(expectedJson);
        System.out.println(actualJson);
        JSONAssert.assertEquals(expectedJson, actualJson, false);
    }

    public void testAddItemsAndVariations() throws Exception {

        GsonBuilder builder = new GsonBuilder();
        Gson gson = builder.create();

        // starting data from database
        HashMap<String, String> locationMarketingPlanCache = gson.fromJson(locationMarketingPlanCacheJson,
                hashmapStringString);
        HashMap<String, List<CsvItem>> marketingPlanItemsCache = gson.fromJson(marketingPlanItemsCacheJson,
                hashmapStringListCsvItem);

        // starting data
        Catalog catalogWithCategories = gson.fromJson(catalogWithCategoriesOnlyJson, Catalog.class);
        Location[] locationResults = gson.fromJson(locationsJson, Location[].class);

        // expected insert
        CatalogObject[] expectedCatalogObjectArrayToInsert = stripItemAndVariationIds(
                gson.fromJson(ItemsToInsertJson, CatalogObject[].class));

        // expected reult
        Catalog expectedCatalog = gson.fromJson(catalogAfterItemInserted, Catalog.class);

        // setup mocks
        SquareClientV2 client = Mockito.mock(SquareClientV2.class);
        CatalogAdapter catalogAdapter = Mockito.mock(CatalogAdapter.class);
        LocationsAdapter locationsAdapter = Mockito.mock(LocationsAdapter.class);

        // call to return in constructor
        Mockito.when(locationsAdapter.list()).thenReturn(locationResults);
        Mockito.when(client.locations()).thenReturn(locationsAdapter);
        Mockito.when(client.catalog()).thenReturn(catalogAdapter);
        Mockito.when(catalogAdapter.retrieveCatalog(Catalog.PrimaryKey.SKU, Catalog.PrimaryKey.NAME,
                Catalog.PrimaryKey.ID, Catalog.PrimaryKey.NAME, Catalog.PrimaryKey.NAME))
                .thenReturn(catalogWithCategories);

        TntCatalogApi tntCatalogApi = new TntCatalogApi(client, locationMarketingPlanCache, marketingPlanItemsCache);

        Catalog resultingCatalog = tntCatalogApi.batchUpsertItemsIntoCatalog();

        Mockito.when(catalogAdapter.retrieveCatalog(Catalog.PrimaryKey.SKU, Catalog.PrimaryKey.NAME,
                Catalog.PrimaryKey.ID, Catalog.PrimaryKey.NAME, Catalog.PrimaryKey.NAME)).thenReturn(expectedCatalog);

        // verifies that the call to batch upsert objects is made with the expected items to insert
        ArgumentCaptor<CatalogObject[]> captor = ArgumentCaptor.forClass(CatalogObject[].class);
        Mockito.verify(catalogAdapter).batchUpsertObjects(captor.capture());
        CatalogObject[] upsertArguments = stripItemAndVariationIds(captor.getValue());
        assertCatalogsEqual(expectedCatalogObjectArrayToInsert, upsertArguments);

        //verifies that the catalog returned is the catalog after the added items
        CatalogObject[] expectedCatalogObjects = stripItemAndVariationIds(expectedCatalog.getObjects());
        CatalogObject[] actualCatalogObjects = stripItemAndVariationIds(resultingCatalog.getObjects());
        assertCatalogsEqual(actualCatalogObjects, expectedCatalogObjects);

    }

    public void testIntegrationTest() throws Exception {
        GsonBuilder builder = new GsonBuilder();
        Gson gson = builder.create();
        SquarePayload deployment = gson.fromJson(deploymentJson, SquarePayload.class);
        SquareClientV2 client = new SquareClientV2(apiUrl, deployment.getAccessToken());
        HashMap<String, String> locationMarketingPlanCache = gson.fromJson(locationMarketingPlanCacheJson,
                hashmapStringString);
        HashMap<String, List<CsvItem>> marketingPlanItemsCache = gson.fromJson(marketingPlanItemsCacheJson,
                hashmapStringListCsvItem);

        TntCatalogApi tntCatalogApi = new TntCatalogApi(client, locationMarketingPlanCache, marketingPlanItemsCache);

        Catalog clearedCatalog = tntCatalogApi.clearCatalog();

        System.out.println("clearedCatalog");
        System.out.println(gson.toJson(clearedCatalog));

        Catalog catalogWithCategoriesOnly = tntCatalogApi.batchUpsertCategoriesFromDatabaseToSquare();

        System.out.println("catalogWithCategoriesOnly");
        System.out.println(gson.toJson(catalogWithCategoriesOnly));

        Catalog catalogAfterItemInserted = tntCatalogApi.batchUpsertItemsIntoCatalog();

        System.out.println("catalogAfterItemInserted");
        System.out.println(gson.toJson(catalogAfterItemInserted));

        Catalog catalogAfterItemsDeleted = tntCatalogApi.removeItemsNotPresentAtAnyLocations();

        System.out.println("catalogAfterItemsDeleted");
        System.out.println(gson.toJson(catalogAfterItemsDeleted));

        CatalogObject[] expected = stripItemAndVariationIds(catalogAfterItemInserted.getObjects());
        CatalogObject[] actual = stripItemAndVariationIds(catalogAfterItemsDeleted.getObjects());

        assertCatalogsEqual(expected, actual); // should be true because on first run, no objects are deleted, so catalog should be equal

        System.out.println("done with first run");

    }

}
